<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Add Tea - My tea collection</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/layout.css" rel="stylesheet">
    <link href="../css/tea-view.css" rel="stylesheet">
    <style rel="stylesheet">
      #add-tea-form select {
        appearance: auto;
      }
    </style>
  </head>
  <body class="bg-light">
    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
      <div class="collapse navbar-collapse" id="navbarsExampleDefault">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a class="nav-link" href="/index">All Teas</a>
          </li>
        </ul>
        <form class="form-inline my-2 my-lg-0">
          <input class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search">
          <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form>
      </div>
    </nav>
    <main role="main" class="container">
      <div class="row">
        <div class="col d-flex justify-content-end">
          <a href="/index" class="btn btn-dark my-2 mb-4">&lt; All Teas</a>
        </div>
      </div>
      <h1 class="jumbotron-heading mb-3">Add New Tea</h1>
      <form th:action="@{/teas/add}" method="post" enctype="multipart/form-data" id="add-tea-form">
        <div class="row">
          <div class="col-md-6">
            <h5 class="mb-3 mt-2">Basic Info:</h5>
            <div class="mb-3">
              <label for="url" class="form-label">Link:</label>
              <input type="url" class="form-control" id="url" name="url">
            </div>
            <div class="mb-3">
              <label for="title" class="form-label">Title:</label>
              <input type="text" class="form-control" id="title" name="title" required>
            </div>
            <div class="mb-3">
              <label for="name" class="form-label">Name:</label>
              <input type="text" class="form-control" id="name" name="name">
            </div>
            <div class="mb-3">
              <label for="types" class="form-label">Tea Type(s):</label>
              <select class="form-control" id="types" name="types" multiple required>
                <option th:each="type : ${teaTypes}"
                        th:value="${type.id}"
                        th:text="${type.name}"></option>
              </select>
              <small class="form-text text-muted">Hold Ctrl (Windows) or Cmd (Mac) to select multiple types.</small>
            </div>
            <div class="mb-3">
              <label for="vendor" class="form-label">Vendor:</label>
              <select class="form-control" id="vendor" name="vendorId" required>
                <option value="" disabled selected>Select a vendor</option>
                <option th:each="vendor : ${vendors}"
                        th:value="${vendor.id}"
                        th:text="${vendor.name}"></option>
              </select>
            </div>
          </div>
          <div class="col-md-6">
            <div class="mb-3 mt-md-5 pt-md-2">
              <label for="description" class="form-label">Description:</label>
              <textarea class="form-control" id="description" name="description" rows="10"></textarea>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-6">
            <h5 class="mb-3 mt-4">Scope:</h5>
            <div class="mb-3">
              <label for="season" class="form-label">Season:</label>
              <input type="text" class="form-control" id="season" name="season">
            </div>
            <div class="mb-3">
              <label for="origin" class="form-label">Origin:</label>
              <input type="text" class="form-control" id="origin" name="origin">
            </div>
            <div class="mb-3">
              <label for="elevation" class="form-label">Elevation:</label>
              <input type="text" class="form-control" id="elevation" name="elevation">
            </div>
            <div class="mb-3">
              <label for="cultivar" class="form-label">Cultivar:</label>
              <input type="text" class="form-control" id="cultivar" name="cultivar">
            </div>
          </div>
          <!-- Other Section -->
          <div class="col-md-6">
            <h5 class="mb-3 mt-4">Other:</h5>
            <div class="mb-3">
              <label for="brewingInstructions" class="form-label">Brewing Instructions:</label>
              <input type="text" class="form-control" id="brewingInstructions" name="brewingInstructions">
            </div>
            <div class="mb-3">
              <label for="tags" class="form-label">Tag(s):</label>
              <select class="form-control" id="tags" name="tags" multiple>
                <option th:each="tag : ${tags}"
                        th:value="${tag.id}"
                        th:text="${tag.label}"></option>
              </select>
              <small class="form-text text-muted">Hold Ctrl (Windows) or Cmd (Mac) to select multiple tags.</small>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-6">
            <h5 class="mb-3 mt-4">Images:</h5>
            <div class="mb-3">
              <label for="images" class="form-label">Tea Images:</label>
              <input type="file" class="form-control" id="images" name="images" multiple accept="image/*" onchange="previewImages(event)">
              <small class="form-text text-muted">You can select multiple images.</small>
              <div id="image-preview-section" class="mt-3">
                <label id="image-preview-heading" class="form-label" style="display:none;">Selected Images:</label>
                <div id="image-preview" class="d-flex flex-wrap"></div>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-12 text-center">
            <button type="submit" class="btn btn-dark mt-4 mb-5">Submit</button>
          </div>
        </div>
      </form>
    </main>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" crossorigin="anonymous"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script>
      function previewImages(event) {
        var preview = $('#image-preview');
        var heading = $('#image-preview-heading');
        preview.empty();
        var files = event.target.files;
        if (files && files.length > 0) {
          heading.show();
          $.each(files, function(i, file) {
            if (file.type.startsWith('image/')) {
              var reader = new FileReader();
              reader.onload = function(e) {
                var img = $('<img>').attr('src', e.target.result)
                  .addClass('img-thumbnail m-1')
                  .css({height: '120px', width: 'auto'});
                preview.append(img);
              };
              reader.readAsDataURL(file);
            }
          });
        } else {
          heading.hide();
        }
      }
    </script>
  </body>
</html>
